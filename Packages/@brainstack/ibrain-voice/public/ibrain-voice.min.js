!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.iBrainVoice=n():e.iBrainVoice=n()}(this,(()=>(()=>{var e={199:e=>{!function(){var e,n=this,a=[{name:"UK English Female",voiceIDs:[3,5,1,6,7,8]},{name:"UK English Male",voiceIDs:[0,4,2,6,7,8]},{name:"US English Female",voiceIDs:[39,40,41,42,43,44]},{name:"Spanish Female",voiceIDs:[19,16,17,18,20,15]},{name:"French Female",voiceIDs:[21,22,23,26]},{name:"Deutsch Female",voiceIDs:[27,28,29,30,31,32]},{name:"Italian Female",voiceIDs:[33,34,35,36,37,38]},{name:"Hungarian Female",voiceIDs:[9,10,11]},{name:"Serbian Male",voiceIDs:[12]},{name:"Croatian Male",voiceIDs:[13]},{name:"Bosnian Male",voiceIDs:[14]},{name:"Fallback UK Female",voiceIDs:[8]}],t=[{name:"Google UK English Male"},{name:"Agnes"},{name:"Daniel Compact"},{name:"Google UK English Female"},{name:"en-GB",rate:.5,pitch:1},{name:"en-AU",rate:.5,pitch:1},{name:"inglés Reino Unido"},{name:"English United Kingdom"},{name:"Fallback en-GB Female",lang:"en-GB",fallbackvoice:!0},{name:"Eszter Compact"},{name:"hu-HU",rate:.4},{name:"Fallback Hungarian",lang:"hu",fallbackvoice:!0},{name:"Fallback Serbian",lang:"sr",fallbackvoice:!0},{name:"Fallback Croatian",lang:"hr",fallbackvoice:!0},{name:"Fallback Bosnian",lang:"bs",fallbackvoice:!0},{name:"Fallback Spanish",lang:"es",fallbackvoice:!0},{name:"Spanish Spain"},{name:"español España"},{name:"Diego Compact",rate:.3},{name:"Google Español"},{name:"es-ES",rate:.3},{name:"Google Français"},{name:"French France"},{name:"francés Francia"},{name:"Virginie Compact",rate:.5},{name:"fr-FR",rate:.5},{name:"Fallback French",lang:"fr",fallbackvoice:!0},{name:"Google Deutsch"},{name:"German Germany"},{name:"alemán Alemania"},{name:"Yannick Compact",rate:.5},{name:"de-DE",rate:.5},{name:"Fallback Deutsch",lang:"de",fallbackvoice:!0},{name:"Google Italiano"},{name:"Italian Italy"},{name:"italiano Italia"},{name:"Paolo Compact",rate:.5},{name:"it-IT",rate:.5},{name:"Fallback Italian",lang:"it",fallbackvoice:!0},{name:"Google US English"},{name:"English United States"},{name:"inglés Estados Unidos"},{name:"Vicki"},{name:"en-US",rate:.5},{name:"Fallback English",lang:"en-US",fallbackvoice:!0}],l=100,i=0,o=!1;function r(){"undefined"==typeof speechSynthesis?c():setTimeout((function(){var a=setInterval((function(){var t=window.speechSynthesis.getVoices();0!=t.length||null!=e&&0!=e.length?(console.log("Voice support ready"),clearInterval(a),e=t,s(),null!=n.OnVoiceReady&&n.OnVoiceReady.call()):(console.log("Voice support NOT ready"),++i>5&&(clearInterval(a),c()))}),100)}),100)}function c(){o=!0,console.log("Voice not supported. Using fallback mode"),s(),null!=n.OnVoiceReady&&n.OnVoiceReady.call()}function s(){for(var e=0;e<a.length;e++)for(var n=a[e],l=0;l<n.voiceIDs.length;l++){var i=t[n.voiceIDs[l]];if(1==i.fallbackvoice){n.mappedProfile={systemvoice:{},collectionvoice:i},console.log("Mapped "+n.name+" to "+i.lang+" fallback voice");break}var o=u(i.name);if(null!=o){n.mappedProfile={systemvoice:o,collectionvoice:i},console.log("Mapped "+n.name+" to "+o.name);break}}}function u(n){if(void 0===e)return null;for(var a=0;a<e.length;a++)if(e[a].name==n)return e[a];return null}function m(e){for(var n=0;n<a.length;n++)if(a[n].name==e)return a[n];return null}this.fallback_playing=!1,this.fallback_parts=null,this.fallback_part_index=0,this.fallback_audio=null,n.msgparameters=null,n.timeoutId=null,n.WORDS_PER_MINUTE=130,n.debug=!1,"undefined"!=typeof speechSynthesis&&(speechSynthesis.onvoiceschanged=function(){e=window.speechSynthesis.getVoices(),null!=n.OnVoiceReady&&n.OnVoiceReady.call()}),this.default_rv=a[0],this.OnVoiceReady=null,"undefined"==typeof $?document.addEventListener("DOMContentLoaded",(function(){r()})):$(document).ready((function(){r()})),n.log=function(e){n.debug&&console.log(e)},this.getVoices=function(){for(var e=[],n=0;n<a.length;n++)e.push({name:a[n].name});return e},this.speak=function(e,a,i){e=e.replace(/[\"\`]/gm,"'"),n.msgparameters=i||{},n.msgtext=e,n.msgvoicename=a,n.onstartFired=!1;var r,c=[];if(e.length>l){for(var s=e;s.length>l;){var f=s.search(/[:!?.;]+/),p="";if((-1==f||f>=l)&&(f=s.search(/[,]+/)),-1==f||f>=l)for(var d=s.split(" "),h=0;h<d.length&&!(p.length+d[h].length+1>l);h++)p+=(0!=h?" ":"")+d[h];else p=s.substr(0,f+1);s=s.substr(p.length,s.length-p.length),c.push(p)}s.length>0&&c.push(s)}else c.push(e);var v={};if(null!=(r=null==a?n.default_rv:m(a)).mappedProfile)v=r.mappedProfile;else if(v.systemvoice=function(e){for(var n=0;n<e.voiceIDs.length;n++){var a=u(t[e.voiceIDs[n]].name);if(null!=a)return a}return null}(r),v.collectionvoice={},null==v.systemvoice)return void console.log("ERROR: No voice found for: "+a);n.msgprofile=v,1==v.collectionvoice.fallbackvoice?(o=!0,n.fallback_parts=[]):o=!1;for(h=0;h<c.length;h++)if(o){var g="http://www.corsproxy.com/translate.google.com/translate_tts?ie=UTF-8&q="+c[h]+"&tl="+v.collectionvoice.lang||0,y=new Audio(g);y.playbackRate=1,y.preload="auto",y.volume=v.collectionvoice.volume||v.systemvoice.volume||1,n.fallback_parts.push(y)}else{var b=new SpeechSynthesisUtterance;b.voice=v.systemvoice,b.voiceURI=v.systemvoice.voiceURI,b.volume=v.collectionvoice.volume||v.systemvoice.volume||1,b.rate=v.collectionvoice.rate||v.systemvoice.rate||1,b.pitch=v.collectionvoice.pitch||v.systemvoice.pitch||1,b.text=c[h],b.lang=v.collectionvoice.lang||v.systemvoice.lang,0==h&&(b.onstart=n.speech_onstart),n.msgparameters.onendcalled=!1,null!=i?(h<c.length-1&&c.length>1||(b.onend=n.speech_onend,b.hasOwnProperty("addEventListener")&&b.addEventListener("end",n.speech_onend)),b.onerror=i.onerror||function(e){n.log("RV: Unknow Error"),n.log(e)}):(n.log("No Params received for current Utterance"),b.onend=n.speech_onend,b.onerror=function(e){n.log("RV: Unknow Error"),n.log(e)}),n.cancelled=!1,speechSynthesis.speak(b)}o&&n.fallback_startPlaying()},this.fallback_startPlaying=function(){n.fallback_part_index=0,n.fallback_finishedplaying()},this.fallback_finishedplaying=function(e){n.fallback_audio=n.fallback_parts[n.fallback_part_index],n.fallback_audio.play(),n.fallback_part_index++,n.fallback_part_index<n.fallback_parts.length&&n.fallback_audio.addEventListener("ended",n.fallback_finishedplaying)},this.cancel=function(){n.checkAndCancelTimeout(),o?n.fallback_audio.pause():n.cancelled=!0,speechSynthesis.cancel()},this.voiceSupport=function(){return"speechSynthesis"in window},n.numToWords=function(e){var a=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,n){var a=[],t=!0,l=!1,i=void 0;try{for(var o,r=e[Symbol.iterator]();!(t=(o=r.next()).done)&&(a.push(o.value),!n||a.length!==n);t=!0);}catch(e){l=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(l)throw i}}return a}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var t,l=function(e){return Number(e)||0},i=function(e){return 0===e.length},o=function(e){return function(n){return n.slice(0,e)}},r=function(e){return function(n){return function(a){return e(n(a))}}},c=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],s=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],u=["","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion","octillion","nonillion"];return"number"==typeof e?n.numToWords(String(e)):"0"===e?"zero":r(function e(n){return function(a){return i(a)?[]:[o(n)(a)].concat(function(e){if(Array.isArray(e)){for(var n=0,a=Array(e.length);n<e.length;n++)a[n]=e[n];return a}return Array.from(e)}(e(n)(function(e){return function(n){return n.slice(e)}}(n)(a))))}}(3))((function(e){return e.slice(0).reverse()}))((t=e,Array.from(t))).map((function(e){var n=a(e,3),t=n[0],i=n[1],o=n[2];return[0===l(o)?"":c[o]+" hundred ",0===l(t)?s[i]:s[i]&&s[i]+" "||"",c[i+t]||c[t]].join("")})).map((function(e,n){return""===e?e:e+" "+u[n]})).filter(r((function(e){return!e}))(i)).reverse().join(" ").trim()},n.getWords=function(e){var a,t=e.split(/(\s*[\s,]\s*|\?|;|:|\.|\(|\)|!)/);t=t.filter((function(e){return/[^\s]/.test(e)}));for(var l=0;l<t.length;l++)null!=(a=t[l].toString().match(/\d+/))&&(t.splice(l,1),n.numToWords(+a[0]).split(/\s+/).map((function(e){t.push(e)})));return t},n.getEstimatedTimeLength=function(e,a){var t=n.getWords(e),l=0,i=o?1300:700;a=a||1;t.map((function(e,n){l+=(e.toString().match(/[^ ]/gim)||e).length}));var r=t.length,c=1e3*a*(60/n.WORDS_PER_MINUTE)*r;return r<5&&(c=a*(i+50*l)),n.log("Estimated time length: "+c+" ms, words: ["+t+"], charsCount: "+l),c},n.startTimeout=function(e,a){var t=n.msgprofile.collectionvoice.timerSpeed;null==n.msgprofile.collectionvoice.timerSpeed&&(t=1),t<=0||(n.timeoutId=setTimeout(a,n.getEstimatedTimeLength(e,t)),n.log("Timeout ID: "+n.timeoutId,e))},n.isPlaying=function(){return n.fallbackMode?null!=n.fallback_audio&&!n.fallback_audio.ended&&!n.fallback_audio.paused:speechSynthesis.speaking},n.checkAndCancelTimeout=function(){null!=n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=null)},n.speech_timedout=function(){n.cancel(),n.cancelled=!1,n.speech_onend()},n.speech_onstart=function(){n.onstartFired=!0,n.log("Speech start"),n.fallbackMode||n.startTimeout(n.msgtext,n.speech_timedout),n.msgparameters.onendcalled=!1,null!=n.msgparameters&&null!=n.msgparameters.onstart&&n.msgparameters.onstart()},n.speech_onend=function(){n.checkAndCancelTimeout(),!0!==n.cancelled?(n.log("on end fired"),null!=n.msgparameters&&null!=n.msgparameters.onend&&1!=n.msgparameters.onendcalled&&(n.log("Speech on end called  -"+n.msgtext),n.msgparameters.onendcalled=!0,n.isPlaying()?console.log("still talking"):n.msgparameters.onend())):n.cancelled=!1},this.OnFinishedPlaying=function(e){null!=n.msgparameters&&null!=n.msgparameters.onend&&n.msgparameters.onend()},this.setDefaultVoice=function(e){var a=m(e);null!=a&&(n.default_vr=a)}}(),e.exports={}}},n={};function a(t){var l=n[t];if(void 0!==l)return l.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,a),i.exports}a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};return(()=>{"use strict";var e;function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e,a,t){return(a=function(e){var a=function(e,a){if("object"!==n(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var l=t.call(e,a||"default");if("object"!==n(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"===n(a)?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}a.r(t),a.d(t,{iBrainVoice:()=>k,voices:()=>i});const i=(l(e={"en-GB":{female:"UK English Female",male:"UK English Male"},"en-US":{female:"US English Female",male:"US English Male"},"es-ES":{female:"Spanish Female",male:"Spanish Male"},"fr-FR":{female:"French Female",male:"French Male"},"de-DE":{female:"German Female",male:"German Male"},"it-IT":{female:"Italian Female",male:"Italian Male"},"el-GR":{female:"Greek Female",male:"Greek Male"},"hu-HU":{female:"Hungarian Female",male:"Hungarian Male"},"tr-TR":{female:"Turkish Female",male:"Turkish Male"},"ru-RU":{female:"Russian Female",male:"Russian Male"},"nl-NL":{female:"Dutch Female",male:"Dutch Male"},"sv-SE":{female:"Swedish Female",male:"Swedish Male"},"nb-NO":{female:"Norwegian Female",male:"Norwegian Male"},"ja-JP":{female:"Japanese Female",male:"Japanese Male"},"ko-KR":{female:"Korean Female",male:"Korean Male"},"zh-CN":{female:"Chinese Female",male:"Chinese Male"}},"en-GB",{female:"UK English Female",male:"UK English Male"}),l(e,"en-US",{female:"US English Female",male:"US English Male"}),l(e,"es-ES",{female:"Spanish Female",male:"Spanish Male"}),l(e,"fr-FR",{female:"French Female",male:"French Male"}),l(e,"de-DE",{female:"German Female",male:"German Male"}),l(e,"it-IT",{female:"Italian Female",male:"Italian Male"}),l(e,"el-GR",{female:"Greek Female",male:"Greek Male"}),l(e,"hu-HU",{female:"Hungarian Female",male:"Hungarian Male"}),l(e,"tr-TR",{female:"Turkish Female",male:"Turkish Male"}),l(e,"ru-RU",{female:"Russian Female",male:"Russian Male"}),l(e,"nl-NL",{female:"Dutch Female",male:"Dutch Male"}),l(e,"sv-SE",{female:"Swedish Female",male:"Swedish Male"}),l(e,"nb-NO",{female:"Norwegian Female",male:"Norwegian Male"}),l(e,"ja-JP",{female:"Japanese Female",male:"Japanese Male"}),l(e,"ko-KR",{female:"Korean Female",male:"Korean Male"}),l(e,"zh-CN",{female:"Chinese Female",male:"Chinese Male"}),l(e,"zh-HK",{female:"Chinese (Hong Kong) Female",male:"Chinese (Hong Kong) Male"}),l(e,"zh-TW",{female:"Chinese Taiwan Female",male:"Chinese Taiwan Male"}),l(e,"hi-IN",{female:"Hindi Female",male:"Hindi Male"}),l(e,"sr-RS",{female:"Serbian Female",male:"Serbian Male"}),l(e,"hr-HR",{female:"Croatian Female",male:"Croatian Male"}),l(e,"bs-BA",{female:"Bosnian Female",male:"Bosnian Male"}),l(e,"ro-RO",{female:"Romanian Female",male:"Romanian Male"}),l(e,"ca-ES",{male:"Catalan Male"}),l(e,"en-AU",{female:"Australian Female",male:"Australian Male"}),l(e,"fi-FI",{female:"Finnish Female",male:"Finnish Male"}),l(e,"af-ZA",{male:"Afrikaans Male"}),l(e,"sq-AL",{male:"Albanian Male"}),l(e,"ar-SA",{female:"Arabic Female",male:"Arabic Male"}),l(e,"hy-AM",{male:"Armenian Male"}),l(e,"cs-CZ",{female:"Czech Female",male:"Czech Male"}),l(e,"da-DK",{female:"Danish Female",male:"Danish Male"}),l(e,"eo",{male:"Esperanto Male"}),l(e,"ht-HT",{female:"Haitian Creole Female"}),l(e,"is-IS",{male:"Icelandic Male"}),l(e,"id-ID",{female:"Indonesian Female",male:"Indonesian Male"}),l(e,"la",{female:"Latin Female",male:"Latin Male"}),l(e,"lv-LV",{male:"Latvian Male"}),l(e,"mk-MK",{male:"Macedonian Male"}),l(e,"mo-MD",{male:"Moldavian Male"}),l(e,"me-ME",{male:"Montenegrin Male"}),l(e,"pl-PL",{female:"Polish Female",male:"Polish Male"}),l(e,"pt-BR",{female:"Brazilian Portuguese Female",male:"Brazilian Portuguese Male"}),l(e,"pt-PT",{female:"Portuguese Female",male:"Portuguese Male"}),l(e,"sk-SK",{female:"Slovak Female",male:"Slovak Male"}),l(e,"es-LA",{female:"Spanish Latin American Female",male:"Spanish Latin American Male"}),l(e,"sw-KE",{male:"Swahili Male"}),l(e,"ta-IN",{male:"Tamil Male"}),l(e,"th-TH",{female:"Thai Female"}),l(e,"vi-VN",{female:"Vietnamese Female",male:"Vietnamese Male"}),l(e,"cy-GB",{male:"Welsh Male"}),e);var o=a(199),r=a.n(o);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function u(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?s(Object(a),!0).forEach((function(n){m(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function m(e,n,a){return(n=p(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function f(e,n){for(var a=0;a<n.length;a++){var t=n[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,p(t.key),t)}}function p(e){var n=function(e,n){if("object"!==c(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var t=a.call(e,n||"default");if("object"!==c(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===c(n)?n:String(n)}function d(e){var n=g();return function(){var a,t=b(e);if(n){var l=b(this).constructor;a=Reflect.construct(t,arguments,l)}else a=t.apply(this,arguments);return function(e,n){if(n&&("object"===c(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,a)}}function h(e){var n="function"==typeof Map?new Map:void 0;return h=function(e){if(null===e||(a=e,-1===Function.toString.call(a).indexOf("[native code]")))return e;var a;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return v(e,arguments,b(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),y(t,e)},h(e)}function v(e,n,a){return v=g()?Reflect.construct.bind():function(e,n,a){var t=[null];t.push.apply(t,n);var l=new(Function.bind.apply(e,t));return a&&y(l,a.prototype),l},v.apply(null,arguments)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e,n){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},y(e,n)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var k=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&y(e,n)}(o,e);var n,a,t,l=d(o);function o(e){var n,a=e.options,t=void 0===a?{}:a,i=e.knowledge,r=void 0===i?"":i,c=e.voice,s=void 0===c?"OK English Male":c,u=e.lang,m=void 0===u?"en-US":u,f=e.decision,p=void 0===f?function(e){return e}:f,d=e.key;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(n=l.call(this)).isRecording=!1,n.chunks=[],n.conversationHistory=[],n.lang=m,n.options=t,n.voice=s,n.knowledge=r,n.decsionAction=p,n.key=d,n.initializeAudioRecording(),n.initializeVoice(n.key),n}return n=o,(a=[{key:"initializeAudioRecording",value:function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var a=new AudioContext,t=a.createMediaStreamSource(n),l=a.createScriptProcessor(1024,1,1);t.connect(l),l.connect(a.destination),l.onaudioprocess=function(a){a.inputBuffer.getChannelData(0).reduce((function(e,n){return e+Math.abs(n)}),0)/1024<.05?e.isRecording&&Date.now()-e.silenceStartTime>=2e3&&(e.isRecording=!1,e.recorder.stop()):(e.isRecording||(e.isRecording=!0,e.chunks=[],e.recorder=new MediaRecorder(n),e.recorder.ondataavailable=function(n){return e.chunks.push(n.data)},e.recorder.onstop=function(){var n=new Blob(e.chunks,{type:"audio/webm"});e.analyze(new File([n],"recording.webm",{type:"audio/webm"}))},e.recorder.start()),e.silenceStartTime=Date.now())}}))}},{key:"initializeVoice",value:function(e){var n=this;if(this.isResponsiveVoiceLoaded=!1,document.getElementById("responsivevoice-script"))this.isResponsiveVoiceLoaded=!0;else{var a=document.createElement("script");a.src="https://code.responsivevoice.org/responsivevoice.js?key=".concat(e),a.id="responsivevoice-script",a.async=!0,a.onload=function(){n.isResponsiveVoiceLoaded=!0},document.head.appendChild(a)}}},{key:"speak",value:function(e,n){var a,t;r().isPlaying()||r().speak(e,(null===(a=this.voices)||void 0===a||null===(t=a[n])||void 0===t?void 0:t.male)||this.voice)}},{key:"analyze",value:function(e){var n=this,a=new FormData;a.append("file",e),fetch(this.knowledge,u(u({},this.options),{},{mode:"cors",method:"POST",body:a})).then((function(e){return e.text()})).then((function(e){n.decsionAction(e)})).catch((function(e){console.log("decsionAction Failed ",e)})).finally((function(){n.start()}))}},{key:"setSpeechLanguage",value:function(e){var n;e&&(this.lang=e,this.voice=(null==i||null===(n=i[e])||void 0===n?void 0:n.male)||this.voice)}},{key:"start",value:function(){this.dispatchEvent(new CustomEvent("listen.start"))}},{key:"stop",value:function(){this.dispatchEvent(new CustomEvent("listen.stop"))}}])&&f(n.prototype,a),t&&f(n,t),Object.defineProperty(n,"prototype",{writable:!1}),o}(h(EventTarget))})(),t})()));